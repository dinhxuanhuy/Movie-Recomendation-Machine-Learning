# üéØ B√†i 8: H·ªá th·ªëng g·ª£i √Ω (Recommendation Systems)

## üìã M·ª•c **TF-IDF (Term Frequency-Inverse Document Frequency):**

$$\text{TF-IDF}(t, d) = \text{TF}(t, d) \times \text{IDF}(t)$$

$$\text{TF}(t, d) = \frac{\text{s·ªë l·∫ßn xu·∫•t hi·ªán c·ªßa t trong d}}{\text{t·ªïng s·ªë t·ª´ trong d}}$$

$$\text{IDF}(t) = \log\left(\frac{\text{t·ªïng s·ªë t√†i li·ªáu}}{1 + \text{s·ªë t√†i li·ªáu ch·ª©a t}}\right)$$

#### üßÆ T√≠nh to√°n th·ª≠ c√¥ng TF-IDF v·ªõi d·ªØ li·ªáu d·∫°ng b·∫£ng

**V√≠ d·ª• ƒë∆°n gi·∫£n:** B·ªô m√¥ t·∫£ 3 phim

| Phim     | M√¥ t·∫£                                    |
|----------|------------------------------------------|
| Avengers | "action hero fight save world"          |
| Titanic  | "love story ship sink ocean"            |
| Iron Man | "action hero technology armor suit"     |

**B∆∞·ªõc 1:** T√≠nh Term Frequency (TF) cho t·ª´ "action"

| Phim     | S·ªë l·∫ßn "action" | T·ªïng s·ªë t·ª´ | TF(action) |
|----------|-----------------|------------|------------|
| Avengers | 1               | 5          | 1/5 = 0.2  |
| Titanic  | 0               | 5          | 0/5 = 0.0  |
| Iron Man | 1               | 5          | 1/5 = 0.2  |

**B∆∞·ªõc 2:** T√≠nh Inverse Document Frequency (IDF) cho t·ª´ "action"
- T·ªïng s·ªë t√†i li·ªáu: 3
- S·ªë t√†i li·ªáu ch·ª©a "action": 2 (Avengers, Iron Man)

$$\text{IDF}(action) = \log\left(\frac{3}{1 + 2}\right) = \log(1) = 0$$

Wait, this is not right. Let me recalculate:

$$\text{IDF}(action) = \log\left(\frac{3}{2}\right) = \log(1.5) = 0.405$$

**B∆∞·ªõc 3:** T√≠nh TF-IDF cho t·ª´ "action"

| Phim     | TF(action) | IDF(action) | TF-IDF(action) |
|----------|------------|-------------|----------------|
| Avengers | 0.2        | 0.405       | 0.2√ó0.405=0.081|
| Titanic  | 0.0        | 0.405       | 0.0√ó0.405=0.000|
| Iron Man | 0.2        | 0.405       | 0.2√ó0.405=0.081|

**B·∫£ng TF-IDF ho√†n ch·ªânh cho t·∫•t c·∫£ t·ª´:**

| Phim     | action | hero | fight | save | world | love | story | ship | sink | ocean | technology | armor | suit |
|----------|--------|------|-------|------|-------|------|-------|------|------|-------|------------|-------|------|
| Avengers | 0.081  | 0.081| 0.162 | 0.162| 0.162 | 0.000| 0.000 | 0.000| 0.000| 0.000 | 0.000      | 0.000 | 0.000|
| Titanic  | 0.000  | 0.000| 0.000 | 0.000| 0.000 | 0.162| 0.081 | 0.162| 0.162| 0.162 | 0.000      | 0.000 | 0.000|
| Iron Man | 0.081  | 0.081| 0.000 | 0.000| 0.000 | 0.000| 0.000 | 0.000| 0.000| 0.000 | 0.162      | 0.162 | 0.162|

**üí° √ù nghƒ©a c·ªßa b·∫£ng TF-IDF:**

**üîç Ph√¢n t√≠ch t·ª´ng t·ª´ kh√≥a:**

**T·ª´ ph·ªï bi·∫øn (ƒëi·ªÉm TF-IDF th·∫•p):**
- **"action", "hero"** (0.081): Xu·∫•t hi·ªán ·ªü 2/3 phim ‚Üí √çt ƒë·∫∑c tr∆∞ng, gi√° tr·ªã ph√¢n bi·ªát th·∫•p
- **"story"** (0.081): Ch·ªâ ·ªü Titanic nh∆∞ng t·ª´ ph·ªï bi·∫øn ‚Üí Kh√¥ng ƒë·ªß ƒë·∫∑c tr∆∞ng

**T·ª´ ƒë·∫∑c tr∆∞ng cao (ƒëi·ªÉm TF-IDF cao):**
- **"fight", "save", "world"** (0.162): Ch·ªâ ·ªü Avengers ‚Üí R·∫•t ƒë·∫∑c tr∆∞ng cho phim si√™u anh h√πng
- **"love", "ship", "sink", "ocean"** (0.162): Ch·ªâ ·ªü Titanic ‚Üí ƒê·∫∑c tr∆∞ng phim t√¨nh c·∫£m/th·∫£m h·ªça
- **"technology", "armor", "suit"** (0.162): Ch·ªâ ·ªü Iron Man ‚Üí ƒê·∫∑c tr∆∞ng c√¥ng ngh·ªá cao

**üìä Ph√¢n nh√≥m theo n·ªôi dung:**

| Nh√≥m phim        | T·ª´ kh√≥a ƒë·∫∑c tr∆∞ng           | TF-IDF Score | √ù nghƒ©a                    |
|------------------|----------------------------|--------------|----------------------------|
| **Si√™u anh h√πng** | fight, save, world        | 0.162        | H√†nh ƒë·ªông c·ª©u th·∫ø gi·ªõi     |
| **T√¨nh c·∫£m**     | love, ship, sink, ocean   | 0.162        | C√¢u chuy·ªán t√¨nh y√™u bi th∆∞∆°ng |
| **C√¥ng ngh·ªá**    | technology, armor, suit   | 0.162        | Phim khoa h·ªçc vi·ªÖn t∆∞·ªüng   |
| **Chung**        | action, hero              | 0.081        | √çt gi√° tr·ªã ph√¢n bi·ªát       |

**üéØ ·ª®ng d·ª•ng trong g·ª£i √Ω:**
- User th√≠ch phim c√≥ t·ª´ "fight, save" ‚Üí G·ª£i √Ω Avengers
- User th√≠ch "love story" ‚Üí G·ª£i √Ω Titanic  
- User quan t√¢m "technology" ‚Üí G·ª£i √Ω Iron Man
- T·ª´ "action" kh√¥ng ƒë·ªß ƒë·ªÉ ph√¢n bi·ªát gi·ªØa Avengers v√† Iron Man

**üîß T·ªëi ∆∞u h√≥a:**
- **TƒÉng tr·ªçng s·ªë** cho c√°c t·ª´ c√≥ TF-IDF cao (0.162)
- **Gi·∫£m tr·ªçng s·ªë** cho c√°c t·ª´ ph·ªï bi·∫øn (0.081)
- **B·ªï sung t·ª´ ƒë·ªìng nghƒ©a** ƒë·ªÉ tƒÉng ƒë·ªô ch√≠nh x√°c

![TF-IDF Illustration](images/tfidf_illustration.png)h·ªçc

Sau khi h·ªçc xong b√†i n√†y, h·ªçc vi√™n s·∫Ω c√≥ kh·∫£ nƒÉng:
- üéØ Hi·ªÉu ƒë∆∞·ª£c kh√°i ni·ªám v√† ·ª©ng d·ª•ng c·ªßa h·ªá th·ªëng g·ª£i √Ω
- üîç Ph√¢n bi·ªát ƒë∆∞·ª£c hai ph∆∞∆°ng ph√°p ch√≠nh: Collaborative Filtering v√† Content-based Filtering
- üìä Tri·ªÉn khai c√°c thu·∫≠t to√°n g·ª£i √Ω c∆° b·∫£n b·∫±ng Python
- üéÆ X√¢y d·ª±ng h·ªá th·ªëng g·ª£i √Ω game/phim ƒë∆°n gi·∫£n
- üìà ƒê√°nh gi√° hi·ªáu su·∫•t c·ªßa h·ªá th·ªëng g·ª£i √Ω

---

## üèóÔ∏è 1. L√Ω thuy·∫øt c∆° b·∫£n

### ü§î H·ªá th·ªëng g·ª£i √Ω l√† g√¨?

H·ªá th·ªëng g·ª£i √Ω (Recommendation System) l√† m·ªôt h·ªá th·ªëng con c·ªßa h·ªá th·ªëng l·ªçc th√¥ng tin, nh·∫±m d·ª± ƒëo√°n "m·ª©c ƒë·ªô ƒë√°nh gi√°" ho·∫∑c "s·ªü th√≠ch" m√† ng∆∞·ªùi d√πng s·∫Ω d√†nh cho m·ªôt s·∫£n ph·∫©m.

### üéØ ·ª®ng d·ª•ng th·ª±c t·∫ø

- **üõí E-commerce**: Amazon g·ª£i √Ω s·∫£n ph·∫©m
- **üé¨ Streaming**: Netflix g·ª£i √Ω phim/series
- **üéµ Music**: Spotify g·ª£i √Ω b√†i h√°t
- **üìö Social Media**: Facebook g·ª£i √Ω b·∫°n b√®
- **üçï Food Delivery**: G·ª£i √Ω m√≥n ƒÉn

### üîß C√°c ph∆∞∆°ng ph√°p ch√≠nh

```mermaid
graph TD
    A[H·ªá th·ªëng g·ª£i √Ω] --> B[Content-based Filtering]
    A --> C[Collaborative Filtering]
    A --> D[Hybrid Methods]
    
    B --> B1[G·ª£i √Ω d·ª±a tr√™n ƒë·∫∑c ƒëi·ªÉm s·∫£n ph·∫©m]
    C --> C1[User-based CF]
    C --> C2[Item-based CF]
    C --> C3[Matrix Factorization]
    D --> D1[K·∫øt h·ª£p nhi·ªÅu ph∆∞∆°ng ph√°p]
```

![So s√°nh c√°c ph∆∞∆°ng ph√°p Recommendation](images/recommendation_methods_comparison.png)

---

## üìä 2. Content-based Filtering (L·ªçc d·ª±a tr√™n n·ªôi dung)

### üéØ Nguy√™n l√Ω ho·∫°t ƒë·ªông

Content-based filtering g·ª£i √Ω c√°c s·∫£n ph·∫©m t∆∞∆°ng t·ª± v·ªõi nh·ªØng s·∫£n ph·∫©m m√† ng∆∞·ªùi d√πng ƒë√£ th√≠ch trong qu√° kh·ª©, d·ª±a tr√™n ƒë·∫∑c ƒëi·ªÉm c·ªßa s·∫£n ph·∫©m.

![Content-based Filtering Process](images/content_based_filtering.png)

### üî¢ C√¥ng th·ª©c to√°n h·ªçc

**ƒê·ªô t∆∞∆°ng t·ª± Cosine:**

$$\text{similarity}(i, j) = \cos(\theta) = \frac{\mathbf{A} \cdot \mathbf{B}}{|\mathbf{A}||\mathbf{B}|} = \frac{\sum_{k=1}^{n} A_k B_k}{\sqrt{\sum_{k=1}^{n} A_k^2} \sqrt{\sum_{k=1}^{n} B_k^2}}$$

Trong ƒë√≥:
- $\mathbf{A}, \mathbf{B}$: Vector ƒë·∫∑c tr∆∞ng c·ªßa hai s·∫£n ph·∫©m
- $A_k, B_k$: Gi√° tr·ªã ƒë·∫∑c tr∆∞ng th·ª© k c·ªßa s·∫£n ph·∫©m A v√† B
- $n$: S·ªë l∆∞·ª£ng ƒë·∫∑c tr∆∞ng

**TF-IDF (Term Frequency-Inverse Document Frequency):**

$$\text{TF-IDF}(t, d) = \text{TF}(t, d) \times \text{IDF}(t)$$

$$\text{TF}(t, d) = \frac{\text{s·ªë l·∫ßn xu·∫•t hi·ªán c·ªßa t trong d}}{\text{t·ªïng s·ªë t·ª´ trong d}}$$

$$\text{IDF}(t) = \log\left(\frac{\text{t·ªïng s·ªë t√†i li·ªáu}}{1 + \text{s·ªë t√†i li·ªáu ch·ª©a t}}\right)$$

![TF-IDF Illustration](images/tfidf_illustration.png)

### üîÑ Quy tr√¨nh ho·∫°t ƒë·ªông

```mermaid
flowchart TD
    A[D·ªØ li·ªáu s·∫£n ph·∫©m] --> B[Tr√≠ch xu·∫•t ƒë·∫∑c tr∆∞ng]
    B --> C[T·∫°o profile ng∆∞·ªùi d√πng]
    C --> D[T√≠nh ƒë·ªô t∆∞∆°ng t·ª±]
    D --> E[S·∫Øp x·∫øp v√† g·ª£i √Ω]
    
    B1[VƒÉn b·∫£n: TF-IDF] --> B
    B2[Th·ªÉ lo·∫°i, nƒÉm s·∫£n xu·∫•t] --> B
    B3[Gi√°, th∆∞∆°ng hi·ªáu] --> B
```

### üßÆ T√≠nh to√°n th·ª≠ c√¥ng v·ªõi d·ªØ li·ªáu d·∫°ng b·∫£ng

**V√≠ d·ª• ƒë∆°n gi·∫£n:** B·∫£ng ƒë·∫∑c tr∆∞ng c·ªßa 4 phim

| Phim         | Action | Romance | Sci-Fi | Comedy |
|--------------|--------|---------|--------|--------|
| Avengers     | 1      | 0       | 1      | 0      |
| Titanic      | 0      | 1       | 0      | 0      |
| Iron Man     | 1      | 0       | 1      | 0      |
| Mr. Bean     | 0      | 0       | 0      | 1      |

**B∆∞·ªõc 1:** T√≠nh ƒë·ªô t∆∞∆°ng t·ª± Cosine gi·ªØa Avengers v√† Iron Man:

- Vector Avengers: [1, 0, 1, 0]
- Vector Iron Man: [1, 0, 1, 0]

$$
\text{similarity} = \frac{\mathbf{A} \cdot \mathbf{B}}{|\mathbf{A}||\mathbf{B}|} = \frac{1 \times 1 + 0 \times 0 + 1 \times 1 + 0 \times 0}{\sqrt{1^2+0^2+1^2+0^2} \times \sqrt{1^2+0^2+1^2+0^2}} = \frac{2}{\sqrt{2} \times \sqrt{2}} = 1.0
$$

**B∆∞·ªõc 2:** T√≠nh ƒë·ªô t∆∞∆°ng t·ª± gi·ªØa Avengers v√† Titanic:

- Vector Avengers: [1, 0, 1, 0]
- Vector Titanic: [0, 1, 0, 0]

$$
\text{similarity} = \frac{1 \times 0 + 0 \times 1 + 1 \times 0 + 0 \times 0}{\sqrt{2} \times \sqrt{1}} = \frac{0}{\sqrt{2}} = 0.0
$$

**B·∫£ng ma tr·∫≠n ƒë·ªô t∆∞∆°ng t·ª± cu·ªëi c√πng:**

| Phim         | Avengers | Titanic | Iron Man | Mr. Bean |
|--------------|----------|---------|----------|----------|
| Avengers     | 1.000    | 0.000   | 1.000    | 0.000    |
| Titanic      | 0.000    | 1.000   | 0.000    | 0.000    |
| Iron Man     | 1.000    | 0.000   | 1.000    | 0.000    |
| Mr. Bean     | 0.000    | 0.000   | 0.000    | 1.000    |

**üí° √ù nghƒ©a c·ªßa ma tr·∫≠n:**
- **ƒê∆∞·ªùng ch√©o = 1.000**: M·ªói phim v·ªõi ch√≠nh n√≥ c√≥ ƒë·ªô t∆∞∆°ng t·ª± ho√†n h·∫£o
- **Avengers-Iron Man = 1.000**: Hai phim c√≥ ƒë·∫∑c tr∆∞ng gi·ªëng h·ªát nhau (c√πng Action + Sci-Fi)
- **Titanic v·ªõi t·∫•t c·∫£ = 0.000**: Phim t√¨nh c·∫£m ho√†n to√†n kh√°c bi·ªát v·ªõi phim h√†nh ƒë·ªông
- **Mr. Bean ƒë·ªôc l·∫≠p**: Phim h√†i kh√¥ng c√≥ ƒëi·ªÉm chung v·ªõi b·∫•t k·ª≥ phim n√†o

**üéØ ·ª®ng d·ª•ng th·ª±c t·∫ø:**
- N·∫øu user th√≠ch Avengers ‚Üí H·ªá th·ªëng s·∫Ω g·ª£i √Ω Iron Man (similarity = 1.0)
- N·∫øu user th√≠ch Titanic ‚Üí Kh√¥ng c√≥ phim t∆∞∆°ng t·ª± ƒë·ªÉ g·ª£i √Ω
- ƒêi·ªÅu n√†y cho th·∫•y t·∫ßm quan tr·ªçng c·ªßa vi·ªác c√≥ ƒë·ªß ƒëa d·∫°ng th·ªÉ lo·∫°i trong database

### üíª V√≠ d·ª• minh h·ªça: H·ªá th·ªëng g·ª£i √Ω phim

```python
import pandas as pd
import numpy as np
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.metrics.pairwise import cosine_similarity

# D·ªØ li·ªáu m·∫´u v·ªÅ phim
movies_data = {
    'title': ['Avengers', 'Iron Man', 'Spider-Man', 'Titanic', 'The Notebook'],
    'genre': ['Action Adventure Sci-Fi', 'Action Adventure Sci-Fi', 
              'Action Adventure Sci-Fi', 'Drama Romance', 'Drama Romance'],
    'description': [
        'superheroes save world team fight aliens',
        'genius billionaire armor suit technology',
        'teenager spider powers responsibility',
        'ship sinks love story ocean',
        'love story memory disease'
    ]
}

df_movies = pd.DataFrame(movies_data)
print("D·ªØ li·ªáu phim:")
print(df_movies)
```

### üßÆ T√≠nh to√°n b∆∞·ªõc by b∆∞·ªõc

```python
# B∆∞·ªõc 1: K·∫øt h·ª£p th√¥ng tin ƒë·ªÉ t·∫°o features
df_movies['features'] = df_movies['genre'] + ' ' + df_movies['description']

# B∆∞·ªõc 2: T·∫°o TF-IDF vectors
tfidf = TfidfVectorizer(stop_words='english')
tfidf_matrix = tfidf.fit_transform(df_movies['features'])

print(f"K√≠ch th∆∞·ªõc ma tr·∫≠n TF-IDF: {tfidf_matrix.shape}")
print(f"C√°c t·ª´ kh√≥a: {list(tfidf.get_feature_names_out()[:10])}")
```

```python
# B∆∞·ªõc 3: T√≠nh ma tr·∫≠n ƒë·ªô t∆∞∆°ng t·ª±
similarity_matrix = cosine_similarity(tfidf_matrix)

print("Ma tr·∫≠n ƒë·ªô t∆∞∆°ng t·ª±:")
similarity_df = pd.DataFrame(similarity_matrix, 
                           index=df_movies['title'], 
                           columns=df_movies['title'])
print(similarity_df.round(3))
```

### üéØ H√†m g·ª£i √Ω

```python
def content_based_recommend(movie_title, similarity_df, top_n=3):
    """
    G·ª£i √Ω phim d·ª±a tr√™n content-based filtering
    
    Parameters:
    movie_title: T√™n phim l√†m c∆° s·ªü
    similarity_df: Ma tr·∫≠n ƒë·ªô t∆∞∆°ng t·ª±
    top_n: S·ªë l∆∞·ª£ng phim g·ª£i √Ω
    
    Returns:
    List c√°c phim ƒë∆∞·ª£c g·ª£i √Ω
    """
    # L·∫•y ƒëi·ªÉm t∆∞∆°ng t·ª± c·ªßa phim ƒë√£ ch·ªçn
    movie_scores = similarity_df[movie_title].sort_values(ascending=False)
    
    # Lo·∫°i b·ªè ch√≠nh n√≥ v√† l·∫•y top_n phim
    recommended_movies = movie_scores.iloc[1:top_n+1]
    
    print(f"G·ª£i √Ω cho phim '{movie_title}':")
    for i, (title, score) in enumerate(recommended_movies.items(), 1):
        print(f"{i}. {title} (ƒë·ªô t∆∞∆°ng t·ª±: {score:.3f})")
    
    return recommended_movies

# Test h√†m g·ª£i √Ω
content_based_recommend('Iron Man', similarity_df)
```

---

## ü§ù 3. Collaborative Filtering (L·ªçc c·ªông t√°c)

### üéØ Nguy√™n l√Ω ho·∫°t ƒë·ªông

Collaborative Filtering d·ª± ƒëo√°n s·ªü th√≠ch c·ªßa ng∆∞·ªùi d√πng d·ª±a tr√™n h√†nh vi c·ªßa nh·ªØng ng∆∞·ªùi d√πng t∆∞∆°ng t·ª± (User-based) ho·∫∑c s·∫£n ph·∫©m t∆∞∆°ng t·ª± (Item-based).

![Collaborative Filtering Process](images/collaborative_filtering_process.png)

### üìä Hai ph∆∞∆°ng ph√°p ch√≠nh

#### üë• User-based Collaborative Filtering

**C√¥ng th·ª©c t√≠nh ƒë·ªô t∆∞∆°ng t·ª± gi·ªØa ng∆∞·ªùi d√πng:**

$$\text{sim}(u, v) = \frac{\sum_{i \in I_{uv}} (r_{ui} - \bar{r}_u)(r_{vi} - \bar{r}_v)}{\sqrt{\sum_{i \in I_{uv}} (r_{ui} - \bar{r}_u)^2} \sqrt{\sum_{i \in I_{uv}} (r_{vi} - \bar{r}_v)^2}}$$

**C√¥ng th·ª©c d·ª± ƒëo√°n rating:**

$$\hat{r}_{ui} = \bar{r}_u + \frac{\sum_{v \in N(u)} \text{sim}(u,v) \times (r_{vi} - \bar{r}_v)}{\sum_{v \in N(u)} |\text{sim}(u,v)|}$$

Trong ƒë√≥:
- $r_{ui}$: Rating c·ªßa user u cho item i
- $\bar{r}_u$: Rating trung b√¨nh c·ªßa user u
- $I_{uv}$: T·∫≠p c√°c item ƒë∆∞·ª£c ƒë√°nh gi√° b·ªüi c·∫£ u v√† v
- $N(u)$: T·∫≠p nh·ªØng user t∆∞∆°ng t·ª± v·ªõi u

#### üé≠ Item-based Collaborative Filtering

**C√¥ng th·ª©c t√≠nh ƒë·ªô t∆∞∆°ng t·ª± gi·ªØa s·∫£n ph·∫©m:**

$$\text{sim}(i, j) = \frac{\sum_{u \in U_{ij}} (r_{ui} - \bar{r}_i)(r_{uj} - \bar{r}_j)}{\sqrt{\sum_{u \in U_{ij}} (r_{ui} - \bar{r}_i)^2} \sqrt{\sum_{u \in U_{ij}} (r_{uj} - \bar{r}_j)^2}}$$

#### üßÆ T√≠nh to√°n th·ª≠ c√¥ng Item-based CF v·ªõi d·ªØ li·ªáu d·∫°ng b·∫£ng

**V√≠ d·ª• ƒë∆°n gi·∫£n:** B·∫£ng rating c·ªßa 4 user cho 4 phim

| User | Avengers | Titanic | Iron Man | Spider-Man |
|------|----------|---------|----------|------------|
| 1    | 5        | 2       | 4        | 3          |
| 2    | 4        | 3       | 5        | 4          |
| 3    | 1        | 5       | 2        | 3          |
| 4    | 5        | 1       | 4        | 5          |

**M·ª•c ti√™u:** T√≠nh ƒë·ªô t∆∞∆°ng t·ª± gi·ªØa Avengers v√† Iron Man

**B∆∞·ªõc 1:** L·∫•y rating c·ªßa c·∫£ hai phim t·ª´ t·∫•t c·∫£ users:
- Avengers: [5, 4, 1, 5], trung b√¨nh: 3.75
- Iron Man: [4, 5, 2, 4], trung b√¨nh: 3.75

**B∆∞·ªõc 2:** T√≠nh ƒë·ªô t∆∞∆°ng t·ª± Pearson Correlation:

$$
\text{sim}(Avengers, Iron Man) = \frac{\sum_{u} (r_{u,Avengers} - \bar{r}_{Avengers})(r_{u,Iron Man} - \bar{r}_{Iron Man})}{\sqrt{\sum_{u} (r_{u,Avengers} - \bar{r}_{Avengers})^2} \sqrt{\sum_{u} (r_{u,Iron Man} - \bar{r}_{Iron Man})^2}}
$$

T√≠nh t·ª´ng th√†nh ph·∫ßn:
- User 1: (5-3.75)(4-3.75) = 1.25 √ó 0.25 = 0.3125
- User 2: (4-3.75)(5-3.75) = 0.25 √ó 1.25 = 0.3125  
- User 3: (1-3.75)(2-3.75) = (-2.75) √ó (-1.75) = 4.8125
- User 4: (5-3.75)(4-3.75) = 1.25 √ó 0.25 = 0.3125

T·ªïng t·ª≠ s·ªë = 0.3125 + 0.3125 + 4.8125 + 0.3125 = 5.75

**B∆∞·ªõc 3:** T√≠nh m·∫´u s·ªë:
- Avengers: ‚àö[(1.25)¬≤ + (0.25)¬≤ + (-2.75)¬≤ + (1.25)¬≤] = ‚àö[1.5625 + 0.0625 + 7.5625 + 1.5625] = ‚àö10.75 = 3.28
- Iron Man: ‚àö[(0.25)¬≤ + (1.25)¬≤ + (-1.75)¬≤ + (0.25)¬≤] = ‚àö[0.0625 + 1.5625 + 3.0625 + 0.0625] = ‚àö4.75 = 2.18

$$
\text{similarity} = \frac{5.75}{3.28 √ó 2.18} = \frac{5.75}{7.15} = 0.80
$$

**B·∫£ng ma tr·∫≠n ƒë·ªô t∆∞∆°ng t·ª± Item-based:**

| Phim       | Avengers | Titanic | Iron Man | Spider-Man |
|------------|----------|---------|----------|------------|
| Avengers   | 1.00     | -0.87   | 0.80     | 0.94       |
| Titanic    | -0.87    | 1.00    | -0.77    | -0.58      |
| Iron Man   | 0.80     | -0.77   | 1.00     | 0.89       |
| Spider-Man | 0.94     | -0.58   | 0.89     | 1.00       |

**üí° √ù nghƒ©a c·ªßa ma tr·∫≠n Item-based:**

**üé¨ Ph√¢n nh√≥m phim r√µ r√†ng:**
- **Nh√≥m h√†nh ƒë·ªông**: Avengers, Iron Man, Spider-Man c√≥ ƒë·ªô t∆∞∆°ng t·ª± cao (0.80-0.94)
- **Phim t√¨nh c·∫£m**: Titanic c√≥ ƒë·ªô t∆∞∆°ng t·ª± √¢m v·ªõi t·∫•t c·∫£ phim h√†nh ƒë·ªông (-0.58 ƒë·∫øn -0.87)

**üìä Ph√¢n t√≠ch t·ª´ng c·∫∑p phim:**
- **Avengers-Spider-Man (0.94)**: Si√™u anh h√πng gi·ªëng nhau nh·∫•t
- **Avengers-Iron Man (0.80)**: C√πng v≈© tr·ª• Marvel, t∆∞∆°ng t·ª± cao
- **Iron Man-Spider-Man (0.89)**: C√πng c√¥ng ngh·ªá + si√™u nƒÉng l·ª±c
- **Titanic-Avengers (-0.87)**: Ho√†n to√†n ƒë·ªëi l·∫≠p (t√¨nh c·∫£m vs h√†nh ƒë·ªông)

**üéØ ·ª®ng d·ª•ng trong g·ª£i √Ω:**
- N·∫øu user xem Avengers ‚Üí G·ª£i √Ω Spider-Man (similarity cao nh·∫•t 0.94)
- N·∫øu user kh√¥ng th√≠ch Titanic ‚Üí C√≥ th·ªÉ s·∫Ω th√≠ch c√°c phim h√†nh ƒë·ªông
- N·∫øu user th√≠ch Iron Man ‚Üí G·ª£i √Ω Spider-Man (0.89) tr∆∞·ªõc Avengers (0.80)

**üîç Insight kinh doanh:**
- **Cross-selling hi·ªáu qu·∫£**: Ng∆∞·ªùi xem phim Marvel c√≥ xu h∆∞·ªõng xem th√™m phim Marvel kh√°c
- **Ph√¢n kh√∫c r√µ r√†ng**: Kh√°ch h√†ng y√™u th√≠ch h√†nh ƒë·ªông vs t√¨nh c·∫£m c√≥ s·ªü th√≠ch tr√°i ng∆∞·ª£c
- **Chi·∫øn l∆∞·ª£c marketing**: C√≥ th·ªÉ t·∫°o g√≥i combo phim c√πng th·ªÉ lo·∫°i

**K·∫øt lu·∫≠n:** Avengers v√† Iron Man c√≥ ƒë·ªô t∆∞∆°ng t·ª± cao (0.80), trong khi Titanic c√≥ xu h∆∞·ªõng ng∆∞·ª£c l·∫°i v·ªõi c√°c phim h√†nh ƒë·ªông.

### üßÆ T√≠nh to√°n th·ª≠ c√¥ng User-based CF v·ªõi d·ªØ li·ªáu d·∫°ng b·∫£ng

**V√≠ d·ª• ƒë∆°n gi·∫£n:** B·∫£ng rating c·ªßa 4 user cho 4 phim

| User | Avengers | Titanic | Iron Man | Spider-Man |
|------|----------|---------|----------|------------|
| 1    | 5        | 2       | 4        | ?          |
| 2    | 4        | 3       | 5        | 4          |
| 3    | 1        | 5       | 2        | 3          |
| 4    | 5        | 1       | 4        | 5          |

**M·ª•c ti√™u:** D·ª± ƒëo√°n rating c·ªßa User 1 cho Spider-Man

**B∆∞·ªõc 1:** T√≠nh ƒë·ªô t∆∞∆°ng t·ª± gi·ªØa User 1 v√† c√°c user kh√°c (ch·ªâ d√πng c√°c phim c·∫£ hai ƒë·ªÅu ƒë√£ rating)

User 1 vs User 2 (d√πng Avengers, Titanic, Iron Man):
- User 1: [5, 2, 4], trung b√¨nh: 3.67
- User 2: [4, 3, 5], trung b√¨nh: 4.0

$$
\text{similarity} = \frac{(5-3.67)(4-4.0) + (2-3.67)(3-4.0) + (4-3.67)(5-4.0)}{\sqrt{(5-3.67)^2+(2-3.67)^2+(4-3.67)^2} \times \sqrt{(4-4.0)^2+(3-4.0)^2+(5-4.0)^2}}
$$

$$
= \frac{1.33 \times (-0) + (-1.67) \times (-1) + 0.33 \times 1}{\sqrt{1.77+2.79+0.11} \times \sqrt{0+1+1}} = \frac{0 + 1.67 + 0.33}{\sqrt{4.67} \times \sqrt{2}} = \frac{2.0}{2.16 \times 1.41} = 0.66
$$

**B∆∞·ªõc 2:** T∆∞∆°ng t·ª± t√≠nh User 1 vs User 3 v√† User 1 vs User 4:
- similarity(1,3) = -0.85 (ng∆∞·ª£c chi·ªÅu)
- similarity(1,4) = 0.95 (r·∫•t gi·ªëng)

**B∆∞·ªõc 3:** D·ª± ƒëo√°n rating cho Spider-Man:

$$
\hat{r}_{1,Spider-Man} = \bar{r}_1 + \frac{\sum_{u \in N} sim(1,u) \times (r_{u,Spider-Man} - \bar{r}_u)}{\sum_{u \in N} |sim(1,u)|}
$$

$$
= 3.67 + \frac{0.66 \times (4-4.0) + (-0.85) \times (3-3.33) + 0.95 \times (5-3.67)}{0.66 + 0.85 + 0.95}
$$

$$
= 3.67 + \frac{0.66 \times 0 + (-0.85) \times (-0.33) + 0.95 \times 1.33}{2.46} = 3.67 + \frac{0 + 0.28 + 1.26}{2.46} = 3.67 + 0.63 = 4.3
$$

**üí° √ù nghƒ©a c·ªßa k·∫øt qu·∫£:**
- **Rating d·ª± ƒëo√°n = 4.3**: User 1 c√≥ kh·∫£ nƒÉng s·∫Ω ƒë√°nh gi√° Spider-Man 4.3/5 sao
- **Cao h∆°n trung b√¨nh c√° nh√¢n (3.67)**: User 1 s·∫Ω th√≠ch Spider-Man h∆°n m·ª©c trung b√¨nh
- **ƒê√≥ng g√≥p ch√≠nh t·ª´ User 4**: similarity(1,4) = 0.95 l√† cao nh·∫•t, User 4 th√≠ch Spider-Man (5 sao)
- **User 3 √≠t ·∫£nh h∆∞·ªüng**: similarity(1,3) = -0.85 (√¢m) n√™n ƒë√°nh gi√° th·∫•p c·ªßa User 3 kh√¥ng l√†m gi·∫£m d·ª± ƒëo√°n

**üîç Ph√¢n t√≠ch chi ti·∫øt b·∫£ng t∆∞∆°ng t·ª±:**

| So s√°nh      | Similarity | √ù nghƒ©a                                    |
|--------------|------------|-------------------------------------------|
| User 1 vs 2  | 0.66       | T∆∞∆°ng ƒë·ªëi gi·ªëng nhau, ·∫£nh h∆∞·ªüng trung b√¨nh |
| User 1 vs 3  | -0.85      | Ng∆∞·ª£c chi·ªÅu ho√†n to√†n, s·ªü th√≠ch ƒë·ªëi l·∫≠p   |
| User 1 vs 4  | 0.95       | R·∫•t gi·ªëng nhau, ·∫£nh h∆∞·ªüng m·∫°nh nh·∫•t       |

**üéØ ·ª®ng d·ª•ng th·ª±c t·∫ø:**
- H·ªá th·ªëng s·∫Ω ∆∞u ti√™n g·ª£i √Ω Spider-Man cho User 1 (ƒëi·ªÉm cao 4.3)
- ƒê·ªô tin c·∫≠y cao v√¨ c√≥ User 4 r·∫•t t∆∞∆°ng t·ª± v√† ƒë√°nh gi√° t√≠ch c·ª±c
- User 3 c√≥ s·ªü th√≠ch ng∆∞·ª£c l·∫°i n√™n kh√¥ng ·∫£nh h∆∞·ªüng ti√™u c·ª±c ƒë·∫øn d·ª± ƒëo√°n

**K·∫øt lu·∫≠n:** D·ª± ƒëo√°n User 1 s·∫Ω cho Spider-Man ƒëi·ªÉm 4.3

### üíª V√≠ d·ª• th·ª±c h√†nh: User-based CF

```python
import pandas as pd
import numpy as np
from sklearn.metrics.pairwise import cosine_similarity

# T·∫°o d·ªØ li·ªáu rating m·∫´u (User-Item matrix)
ratings_data = {
    'user': [1, 1, 1, 2, 2, 3, 3, 3, 4, 4, 5, 5, 5],
    'item': ['A', 'B', 'C', 'A', 'C', 'B', 'C', 'D', 'A', 'D', 'B', 'C', 'D'],
    'rating': [5, 3, 4, 4, 5, 3, 4, 5, 5, 4, 4, 3, 4]
}

df_ratings = pd.DataFrame(ratings_data)

# T·∫°o User-Item matrix
user_item_matrix = df_ratings.pivot(index='user', columns='item', values='rating')
print("Ma tr·∫≠n User-Item:")
print(user_item_matrix.fillna(0))
```

![User-Item Matrix Visualization](images/user_item_matrix.png)

```python
# ƒêi·ªÅn gi√° tr·ªã thi·∫øu b·∫±ng 0 v√† t√≠nh ma tr·∫≠n t∆∞∆°ng t·ª±
user_matrix_filled = user_item_matrix.fillna(0)
user_similarity = cosine_similarity(user_matrix_filled)

print("Ma tr·∫≠n ƒë·ªô t∆∞∆°ng t·ª± gi·ªØa c√°c user:")
user_sim_df = pd.DataFrame(user_similarity, 
                          index=user_item_matrix.index, 
                          columns=user_item_matrix.index)
print(user_sim_df.round(3))
```

### üîÆ H√†m d·ª± ƒëo√°n rating

```python
def predict_rating_user_based(user_id, item_id, user_item_matrix, user_similarity, k=2):
    """
    D·ª± ƒëo√°n rating cho user-item b·∫±ng User-based CF
    
    Parameters:
    user_id: ID c·ªßa user
    item_id: ID c·ªßa item
    user_item_matrix: Ma tr·∫≠n User-Item
    user_similarity: Ma tr·∫≠n ƒë·ªô t∆∞∆°ng t·ª± user
    k: S·ªë l∆∞·ª£ng user t∆∞∆°ng t·ª± s·ª≠ d·ª•ng
    
    Returns:
    Predicted rating
    """
    # N·∫øu user ƒë√£ rating item n√†y
    if not pd.isna(user_item_matrix.loc[user_id, item_id]):
        return user_item_matrix.loc[user_id, item_id]
    
    # T√¨m k user t∆∞∆°ng t·ª± nh·∫•t ƒë√£ rating item n√†y
    user_ratings = user_item_matrix[item_id].dropna()
    similarities = user_similarity[user_id-1]  # Chuy·ªÉn v·ªÅ index 0
    
    # T√≠nh rating trung b√¨nh c·ªßa user
    user_mean = user_item_matrix.loc[user_id].mean()
    
    numerator = 0
    denominator = 0
    
    for other_user_id in user_ratings.index:
        if other_user_id != user_id:
            similarity = similarities[other_user_id-1]
            other_rating = user_ratings[other_user_id]
            other_mean = user_item_matrix.loc[other_user_id].mean()
            
            numerator += similarity * (other_rating - other_mean)
            denominator += abs(similarity)
    
    if denominator == 0:
        return user_mean
    
    predicted_rating = user_mean + (numerator / denominator)
    return max(1, min(5, predicted_rating))  # Gi·ªõi h·∫°n trong kho·∫£ng [1, 5]

# Test d·ª± ƒëo√°n
predicted = predict_rating_user_based(1, 'D', user_item_matrix, user_similarity)
print(f"D·ª± ƒëo√°n rating c·ªßa User 1 cho Item D: {predicted:.2f}")
```

---

## üîß 4. Tri·ªÉn khai th·ª±c t·∫ø v·ªõi Python

### üì¶ C√†i ƒë·∫∑t th∆∞ vi·ªán c·∫ßn thi·∫øt

```python
# requirements.txt
pandas==1.5.3
numpy==1.24.3
scikit-learn==1.2.2
matplotlib==3.7.1
seaborn==0.12.2
nltk==3.8.1
streamlit==1.22.0
```

### üéÆ X√¢y d·ª±ng h·ªá th·ªëng g·ª£i √Ω game

```python
import pandas as pd
import numpy as np
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.metrics.pairwise import cosine_similarity
import nltk
from nltk.stem.snowball import SnowballStemmer
import re

class GameRecommendationSystem:
    def __init__(self):
        self.games_df = None
        self.tfidf_vectorizer = None
        self.similarity_matrix = None
        self.stemmer = SnowballStemmer("english")
    
    def tokenize_and_stem(self, text):
        """Tokenize v√† stem text"""
        # Tokenize
        tokens = [word for sent in nltk.sent_tokenize(text) 
                  for word in nltk.word_tokenize(sent)]
        
        # L·ªçc token
        filtered_tokens = [token for token in tokens if re.search('[a-zA-Z]', token)]
        
        # Stem
        stems = [self.stemmer.stem(word) for word in filtered_tokens]
        
        return stems
    
    def load_data(self, file_path):
        """Load d·ªØ li·ªáu game"""
        self.games_df = pd.read_csv(file_path)
        print(f"ƒê√£ load {len(self.games_df)} games")
    
    def build_features(self):
        """X√¢y d·ª±ng features cho recommendation"""
        # T·∫°o TF-IDF vectors
        self.tfidf_vectorizer = TfidfVectorizer(
            max_df=0.8,
            max_features=200000,
            min_df=0.2,
            stop_words='english',
            use_idf=True,
            tokenizer=self.tokenize_and_stem,
            ngram_range=(1, 3)
        )
        
        tfidf_matrix = self.tfidf_vectorizer.fit_transform(self.games_df["description"])
        
        # T√≠nh ma tr·∫≠n ƒë·ªô t∆∞∆°ng t·ª±
        self.similarity_matrix = cosine_similarity(tfidf_matrix)
        
        print("ƒê√£ x√¢y d·ª±ng xong features v√† ma tr·∫≠n t∆∞∆°ng t·ª±")
    
    def recommend_games(self, game_title, top_n=5):
        """G·ª£i √Ω games t∆∞∆°ng t·ª±"""
        try:
            # T√¨m index c·ªßa game
            game_idx = self.games_df[self.games_df['title'] == game_title].index[0]
            
            # L·∫•y ƒëi·ªÉm t∆∞∆°ng t·ª±
            sim_scores = list(enumerate(self.similarity_matrix[game_idx]))
            
            # S·∫Øp x·∫øp theo ƒëi·ªÉm t∆∞∆°ng t·ª±
            sim_scores = sorted(sim_scores, key=lambda x: x[1], reverse=True)
            
            # L·∫•y top_n (kh√¥ng k·ªÉ ch√≠nh n√≥)
            sim_scores = sim_scores[1:top_n+1]
            
            # L·∫•y indices
            game_indices = [i[0] for i in sim_scores]
            
            # Return games
            recommended_games = self.games_df.iloc[game_indices][['title', 'genre']]
            recommended_games['similarity_score'] = [score[1] for score in sim_scores]
            
            return recommended_games
            
        except IndexError:
            print(f"Kh√¥ng t√¨m th·∫•y game '{game_title}'")
            return None

# S·ª≠ d·ª•ng h·ªá th·ªëng
# recommender = GameRecommendationSystem()
# recommender.load_data('games_dataset.csv')
# recommender.build_features()
# recommendations = recommender.recommend_games('Super Mario Bros')
# print(recommendations)
```

---

## üìà 5. ƒê√°nh gi√° hi·ªáu su·∫•t

### üéØ C√°c metrics ƒë√°nh gi√°

### üìä Accuracy Metrics

#### üßÆ T√≠nh to√°n th·ª≠ c√¥ng MAE v√† RMSE v·ªõi d·ªØ li·ªáu d·∫°ng b·∫£ng

**V√≠ d·ª• ƒë∆°n gi·∫£n:** So s√°nh rating th·ª±c t·∫ø v√† d·ª± ƒëo√°n

| User-Item | Rating th·ª±c t·∫ø | Rating d·ª± ƒëo√°n | Sai s·ªë tuy·ªát ƒë·ªëi | Sai s·ªë b√¨nh ph∆∞∆°ng |
|-----------|----------------|----------------|------------------|--------------------|
| U1-I1     | 4.0           | 3.8            | |4.0-3.8|=0.2     | (4.0-3.8)¬≤=0.04   |
| U1-I2     | 3.0           | 3.5            | |3.0-3.5|=0.5     | (3.0-3.5)¬≤=0.25   |
| U2-I1     | 5.0           | 4.2            | |5.0-4.2|=0.8     | (5.0-4.2)¬≤=0.64   |
| U2-I2     | 2.0           | 2.5            | |2.0-2.5|=0.5     | (2.0-2.5)¬≤=0.25   |
| U3-I1     | 4.5           | 4.0            | |4.5-4.0|=0.5     | (4.5-4.0)¬≤=0.25   |

**B∆∞·ªõc 1:** T√≠nh Mean Absolute Error (MAE):

$$MAE = \frac{1}{n} \sum_{i=1}^{n} |y_i - \hat{y}_i| = \frac{0.2 + 0.5 + 0.8 + 0.5 + 0.5}{5} = \frac{2.5}{5} = 0.5$$

**B∆∞·ªõc 2:** T√≠nh Root Mean Square Error (RMSE):

$$RMSE = \sqrt{\frac{1}{n} \sum_{i=1}^{n} (y_i - \hat{y}_i)^2} = \sqrt{\frac{0.04 + 0.25 + 0.64 + 0.25 + 0.25}{5}} = \sqrt{\frac{1.43}{5}} = \sqrt{0.286} = 0.535$$

**üí° √ù nghƒ©a c·ªßa MAE v√† RMSE:**

**üìä So s√°nh c√°c metrics:**
- **MAE = 0.5**: Sai s·ªë trung b√¨nh l√† 0.5 ƒëi·ªÉm rating
- **RMSE = 0.535**: Cao h∆°n MAE, cho th·∫•y c√≥ sai s·ªë l·ªõn

**üîç Ph√¢n t√≠ch chi ti·∫øt:**
- **Sai s·ªë nh·ªè** (U1-I1: 0.2): D·ª± ƒëo√°n t·ªët, g·∫ßn v·ªõi th·ª±c t·∫ø
- **Sai s·ªë trung b√¨nh** (U1-I2, U2-I2, U3-I1: 0.5): Ch·∫•p nh·∫≠n ƒë∆∞·ª£c
- **Sai s·ªë l·ªõn** (U2-I1: 0.8): D·ª± ƒëo√°n k√©m, c·∫ßn c·∫£i thi·ªán

**‚öñÔ∏è ƒê√°nh gi√° ch·∫•t l∆∞·ª£ng h·ªá th·ªëng:**

| Kho·∫£ng MAE | Ch·∫•t l∆∞·ª£ng    | √ù nghƒ©a                           |
|------------|---------------|-----------------------------------|
| 0.0 - 0.3  | Xu·∫•t s·∫Øc      | D·ª± ƒëo√°n r·∫•t ch√≠nh x√°c            |
| 0.3 - 0.5  | T·ªët           | Ch·∫•p nh·∫≠n ƒë∆∞·ª£c cho production     |
| 0.5 - 0.7  | Trung b√¨nh    | C·∫ßn c·∫£i thi·ªán thu·∫≠t to√°n         |
| > 0.7      | K√©m           | Kh√¥ng n√™n deploy                 |

**üéØ H√†nh ƒë·ªông c·∫£i thi·ªán:**
- **MAE = 0.5** ‚Üí H·ªá th·ªëng ·ªü m·ª©c **trung b√¨nh**, c·∫ßn t·ªëi ∆∞u
- **RMSE > MAE** ‚Üí C√≥ outliers (U2-I1), c·∫ßn x·ª≠ l√Ω ƒë·∫∑c bi·ªát
- **G·ª£i √Ω**: ƒêi·ªÅu ch·ªânh tham s·ªë, b·ªï sung features, ho·∫∑c k·∫øt h·ª£p nhi·ªÅu m√¥ h√¨nh

**K·∫øt lu·∫≠n:** MAE = 0.5, RMSE = 0.535. RMSE cao h∆°n MAE cho th·∫•y c√≥ m·ªôt s·ªë sai s·ªë l·ªõn (nh∆∞ U2-I1).

#### üéØ Ranking Metrics

#### üßÆ T√≠nh to√°n th·ª≠ c√¥ng Precision@K v√† Recall@K

**V√≠ d·ª•:** G·ª£i √Ω top-5 phim cho user, trong ƒë√≥ user th·ª±c s·ª± th√≠ch 8 phim

**K·∫øt qu·∫£ g·ª£i √Ω top-5:**
| Th·ª© t·ª± | Phim g·ª£i √Ω | Th·ª±c t·∫ø th√≠ch? |
|--------|------------|----------------|
| 1      | Avengers   | ‚úì C√≥           |
| 2      | Iron Man   | ‚úì C√≥           |
| 3      | Titanic    | ‚úó Kh√¥ng        |
| 4      | Spider-Man | ‚úì C√≥           |
| 5      | Batman     | ‚úó Kh√¥ng        |

**Relevant items:** T·ªïng 8 phim user th·ª±c s·ª± th√≠ch
**Retrieved@5:** 5 phim ƒë∆∞·ª£c g·ª£i √Ω
**Relevant ‚à© Retrieved@5:** 3 phim (Avengers, Iron Man, Spider-Man)

**B∆∞·ªõc 1:** T√≠nh Precision@5:
$$Precision@5 = \frac{|Relevant \cap Retrieved@5|}{K} = \frac{3}{5} = 0.6 = 60\%$$

**B∆∞·ªõc 2:** T√≠nh Recall@5:
$$Recall@5 = \frac{|Relevant \cap Retrieved@5|}{|Relevant|} = \frac{3}{8} = 0.375 = 37.5\%$$

**B·∫£ng so s√°nh v·ªõi c√°c K kh√°c nhau:**

| K  | Relevant trong top-K | Precision@K | Recall@K |
|----|---------------------|-------------|----------|
| 1  | 1                   | 1/1 = 100%  | 1/8 = 12.5% |
| 3  | 2                   | 2/3 = 66.7% | 2/8 = 25%   |
| 5  | 3                   | 3/5 = 60%   | 3/8 = 37.5% |
| 10 | 5                   | 5/10 = 50%  | 5/8 = 62.5% |

**üí° √ù nghƒ©a c·ªßa Precision@K v√† Recall@K:**

**üéØ Gi·∫£i th√≠ch c√°c ch·ªâ s·ªë:**
- **Precision@K**: T·ª∑ l·ªá phim "ƒë√∫ng gu" trong K phim ƒë∆∞·ª£c g·ª£i √Ω
- **Recall@K**: T·ª∑ l·ªá phim y√™u th√≠ch ƒë∆∞·ª£c "t√¨m ra" trong top-K
- **Trade-off**: Precision gi·∫£m khi K tƒÉng, nh∆∞ng Recall tƒÉng

**üìä Ph√¢n t√≠ch t·ª´ng m·ª©c K:**

**K=1 (G·ª£i √Ω duy nh·∫•t):**
- **Precision = 100%**: Ch·∫Øc ch·∫Øn ƒë√∫ng gu, nh∆∞ng r·∫•t h·∫°n ch·∫ø
- **Recall = 12.5%**: Ch·ªâ t√¨m ƒë∆∞·ª£c 1/8 phim y√™u th√≠ch
- **·ª®ng d·ª•ng**: G·ª£i √Ω "phim hot nh·∫•t" cho homepage

**K=5 (G·ª£i √Ω ti√™u chu·∫©n):**
- **Precision = 60%**: 3/5 phim ƒë√∫ng gu, ch·∫•t l∆∞·ª£ng kh√° t·ªët
- **Recall = 37.5%**: T√¨m ƒë∆∞·ª£c g·∫ßn 40% s·ªü th√≠ch c·ªßa user
- **·ª®ng d·ª•ng**: Danh s√°ch g·ª£i √Ω ch√≠nh tr√™n trang web

**K=10 (G·ª£i √Ω m·ªü r·ªông):**
- **Precision = 50%**: Ch·∫•t l∆∞·ª£ng gi·∫£m nh∆∞ng v·∫´n ch·∫•p nh·∫≠n ƒë∆∞·ª£c
- **Recall = 62.5%**: T√¨m ƒë∆∞·ª£c h∆°n m·ªôt n·ª≠a s·ªü th√≠ch
- **·ª®ng d·ª•ng**: Trang "kh√°m ph√° th√™m" ho·∫∑c email marketing

**üîç Insight kinh doanh:**

| Chi·∫øn l∆∞·ª£c    | K t·ªëi ∆∞u | L√Ω do                               | ·ª®ng d·ª•ng               |
|---------------|----------|-------------------------------------|------------------------|
| **Ch·∫•t l∆∞·ª£ng cao** | K=1-3    | Precision cao, √≠t r·ªßi ro user kh√¥ng th√≠ch | Homepage, notification |
| **C√¢n b·∫±ng**      | K=5-7    | C√¢n b·∫±ng gi·ªØa ch·∫•t l∆∞·ª£ng v√† ƒëa d·∫°ng    | Trang ch√≠nh, carousel  |
| **Kh√°m ph√°**      | K=10+    | Recall cao, gi√∫p user t√¨m s·ªü th√≠ch m·ªõi | Trang browse, search   |

**‚ö° T·ªëi ∆∞u h√≥a th·ª±c t·∫ø:**
- **A/B Testing**: Th·ª≠ nghi·ªám K kh√°c nhau ƒë·ªÉ t√¨m conversion rate t·ªët nh·∫•t
- **Personalized K**: User m·ªõi d√πng K nh·ªè (precision cao), user c≈© d√πng K l·ªõn (ƒëa d·∫°ng)
- **Context-aware**: K nh·ªè tr√™n mobile, K l·ªõn tr√™n desktop

**K·∫øt lu·∫≠n:** Precision gi·∫£m khi K tƒÉng (ch·∫•t l∆∞·ª£ng gi·∫£m), nh∆∞ng Recall tƒÉng (ƒë·ªô ph·ªß tƒÉng).

**Mean Absolute Error (MAE):**
$$MAE = \frac{1}{|T|} \sum_{(u,i) \in T} |r_{ui} - \hat{r}_{ui}|$$

**Root Mean Square Error (RMSE):**
$$RMSE = \sqrt{\frac{1}{|T|} \sum_{(u,i) \in T} (r_{ui} - \hat{r}_{ui})^2}$$

#### üéØ Ranking Metrics
**Precision@K:**
$$Precision@K = \frac{|Relevant \cap Retrieved@K|}{K}$$

**Recall@K:**
$$Recall@K = \frac{|Relevant \cap Retrieved@K|}{|Relevant|}$$

### üíª Code ƒë√°nh gi√°

```python
from sklearn.model_selection import train_test_split
from sklearn.metrics import mean_absolute_error, mean_squared_error
import numpy as np

def evaluate_recommendation_system(true_ratings, predicted_ratings):
    """ƒê√°nh gi√° h·ªá th·ªëng g·ª£i √Ω"""
    mae = mean_absolute_error(true_ratings, predicted_ratings)
    rmse = np.sqrt(mean_squared_error(true_ratings, predicted_ratings))
    
    print(f"Mean Absolute Error (MAE): {mae:.3f}")
    print(f"Root Mean Square Error (RMSE): {rmse:.3f}")
    
    return {'MAE': mae, 'RMSE': rmse}

def precision_at_k(recommended_items, relevant_items, k):
    """T√≠nh Precision@K"""
    recommended_k = recommended_items[:k]
    relevant_and_recommended = set(recommended_k) & set(relevant_items)
    return len(relevant_and_recommended) / k

def recall_at_k(recommended_items, relevant_items, k):
    """T√≠nh Recall@K"""
    recommended_k = recommended_items[:k]
    relevant_and_recommended = set(recommended_k) & set(relevant_items)
    return len(relevant_and_recommended) / len(relevant_items)
```

---

## üîÑ 6. So s√°nh c√°c ph∆∞∆°ng ph√°p

| ƒê·∫∑c ƒëi·ªÉm | Content-based | Collaborative Filtering |
|----------|---------------|------------------------|
| **üéØ Nguy√™n l√Ω** | ƒê·∫∑c tr∆∞ng s·∫£n ph·∫©m | H√†nh vi ng∆∞·ªùi d√πng |
| **‚úÖ ∆Øu ƒëi·ªÉm** | Kh√¥ng c·∫ßn d·ªØ li·ªáu user kh√°c<br>Gi·∫£i th√≠ch ƒë∆∞·ª£c | Kh√¥ng c·∫ßn ph√¢n t√≠ch n·ªôi dung<br>Kh√°m ph√° ƒë∆∞·ª£c s·ªü th√≠ch m·ªõi |
| **‚ùå Nh∆∞·ª£c ƒëi·ªÉm** | H·∫°n ch·∫ø ƒëa d·∫°ng<br>C·∫ßn domain knowledge | Cold start problem<br>Data sparsity |
| **üéÆ ·ª®ng d·ª•ng** | News, Documents | E-commerce, Movies |

### üîó Hybrid Methods

#### üßÆ T√≠nh to√°n th·ª≠ c√¥ng Hybrid Recommendation v·ªõi d·ªØ li·ªáu d·∫°ng b·∫£ng

**V√≠ d·ª•:** K·∫øt h·ª£p Content-based v√† Collaborative Filtering

**B∆∞·ªõc 1:** ƒêi·ªÉm t·ª´ Content-based (d·ª±a tr√™n ƒë·∫∑c tr∆∞ng phim)

| User | Phim      | Content Score | L√Ω do                              |
|------|-----------|---------------|-----------------------------------|
| 1    | Iron Man  | 0.85         | Gi·ªëng Avengers (ƒë√£ th√≠ch)         |
| 1    | Titanic   | 0.20         | Kh√°c bi·ªát ho√†n to√†n v·ªõi s·ªü th√≠ch  |
| 1    | Batman    | 0.90         | R·∫•t gi·ªëng phim h√†nh ƒë·ªông ƒë√£ th√≠ch |

**B∆∞·ªõc 2:** ƒêi·ªÉm t·ª´ Collaborative Filtering (d·ª±a tr√™n user t∆∞∆°ng t·ª±)

| User | Phim      | CF Score | L√Ω do                                    |
|------|-----------|----------|------------------------------------------|
| 1    | Iron Man  | 0.75     | Users t∆∞∆°ng t·ª± ƒë√°nh gi√° cao             |
| 1    | Titanic   | 0.45     | M·ªôt s·ªë users t∆∞∆°ng t·ª± th√≠ch             |
| 1    | Batman    | 0.80     | ƒêa s·ªë users t∆∞∆°ng t·ª± ƒë√°nh gi√° t√≠ch c·ª±c  |

**B∆∞·ªõc 3:** K·∫øt h·ª£p b·∫±ng Weighted Average (Œ± = 0.6 cho Content-based, Œ≤ = 0.4 cho CF)

$$\text{Final Score} = \alpha \times \text{Content Score} + \beta \times \text{CF Score}$$

| User | Phim      | Content | CF   | Final Score | Calculation |
|------|-----------|---------|------|-------------|-------------|
| 1    | Iron Man  | 0.85    | 0.75 | 0.81        | 0.6√ó0.85 + 0.4√ó0.75 = 0.51 + 0.30 = 0.81 |
| 1    | Titanic   | 0.20    | 0.45 | 0.30        | 0.6√ó0.20 + 0.4√ó0.45 = 0.12 + 0.18 = 0.30 |
| 1    | Batman    | 0.90    | 0.80 | 0.86        | 0.6√ó0.90 + 0.4√ó0.80 = 0.54 + 0.32 = 0.86 |

**üí° √ù nghƒ©a c·ªßa k·∫øt qu·∫£ Hybrid:**

**üéØ Ph√¢n t√≠ch t·ª´ng phim:**

**Batman (Final Score = 0.86) - ƒê∆Ø·ª¢C G·ª¢I √ù TOP 1:**
- **Content-based = 0.90**: R·∫•t gi·ªëng phim h√†nh ƒë·ªông user ƒë√£ th√≠ch
- **CF = 0.80**: Users t∆∞∆°ng t·ª± c≈©ng ƒë√°nh gi√° cao
- **K·∫øt h·ª£p**: C·∫£ hai ph∆∞∆°ng ph√°p ƒë·ªÅu ƒë·ªìng √Ω ‚Üí ƒê·ªô tin c·∫≠y cao

**Iron Man (Final Score = 0.81) - G·ª¢I √ù TH·ª® 2:**
- **Content-based = 0.85**: Gi·ªëng Avengers (c√πng th·ªÉ lo·∫°i)
- **CF = 0.75**: M·ªôt s·ªë users t∆∞∆°ng t·ª± th√≠ch, nh∆∞ng kh√¥ng m·∫°nh b·∫±ng Batman
- **K·∫øt h·ª£p**: ƒêi·ªÉm t·ªët nh∆∞ng th·∫•p h∆°n Batman do CF score th·∫•p h∆°n

**Titanic (Final Score = 0.30) - KH√îNG G·ª¢I √ù:**
- **Content-based = 0.20**: Kh√°c bi·ªát ho√†n to√†n v·ªõi s·ªü th√≠ch hi·ªán t·∫°i
- **CF = 0.45**: M·ªôt s·ªë users c√≥ s·ªü th√≠ch ƒëa d·∫°ng ƒë√£ xem
- **K·∫øt h·ª£p**: CF score cao h∆°n nh∆∞ng kh√¥ng ƒë·ªß b√π ƒë·∫Øp Content score th·∫•p

**üîç ∆Øu ƒëi·ªÉm c·ªßa Hybrid Method:**

| V·∫•n ƒë·ªÅ                | Content-based | CF  | Hybrid Solution |
|----------------------|---------------|-----|-----------------|
| **Cold Start**       | ‚úÖ Gi·∫£i quy·∫øt ƒë∆∞·ª£c | ‚ùå Kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c | ‚úÖ D√πng Content khi thi·∫øu data CF |
| **Over-specialization** | ‚ùå Ch·ªâ g·ª£i √Ω gi·ªëng nhau | ‚úÖ ƒêa d·∫°ng | ‚úÖ CF b·ªï sung s·ª± ƒëa d·∫°ng |
| **ƒê·ªô ch√≠nh x√°c**     | ‚ö° Trung b√¨nh | ‚ö° Trung b√¨nh | ‚úÖ Cao h∆°n c·∫£ hai |

**‚öñÔ∏è ƒêi·ªÅu ch·ªânh tr·ªçng s·ªë Œ± v√† Œ≤:**
- **Œ±=0.8, Œ≤=0.2**: ∆Øu ti√™n Content ‚Üí Ph√π h·ª£p user m·ªõi, item m·ªõi
- **Œ±=0.4, Œ≤=0.6**: ∆Øu ti√™n CF ‚Üí Ph√π h·ª£p user c≈©, h·ªá th·ªëng l·ªõn
- **Œ±=0.6, Œ≤=0.4**: C√¢n b·∫±ng ‚Üí Ph√π h·ª£p ƒëa s·ªë tr∆∞·ªùng h·ª£p

**üéØ Chi·∫øn l∆∞·ª£c th·ª±c t·∫ø:**
- **New user**: Œ± cao ‚Üí D·ª±a v√†o ƒë·∫∑c tr∆∞ng s·∫£n ph·∫©m
- **Active user**: Œ≤ cao ‚Üí D·ª±a v√†o h√†nh vi community  
- **Popular items**: D√πng CF nhi·ªÅu h∆°n
- **Niche items**: D√πng Content nhi·ªÅu h∆°n

**K·∫øt qu·∫£ cu·ªëi c√πng:** Batman (0.86) > Iron Man (0.81) > Titanic (0.30)

**C√°c ph∆∞∆°ng ph√°p Hybrid kh√°c:**

| Ph∆∞∆°ng ph√°p | C√°ch ho·∫°t ƒë·ªông | V√≠ d·ª• t√≠nh to√°n |
|-------------|----------------|-----------------|
| **Switching** | Ch·ªçn ph∆∞∆°ng ph√°p t·ªët nh·∫•t | N·∫øu user m·ªõi: d√πng Content-based<br>N·∫øu user c≈©: d√πng CF |
| **Cascade** | L·ªçc d·∫ßn qua t·ª´ng giai ƒëo·∫°n | B∆∞·ªõc 1: Content-based l·ªçc top-100<br>B∆∞·ªõc 2: CF s·∫Øp x·∫øp l·∫°i top-10 |
| **Feature Combination** | K·∫øt h·ª£p features | Vector = [Content Features + CF Features] |

```mermaid
graph LR
    A[Content-based Score] --> C[Weighted Combination]
    B[Collaborative Score] --> C
    C --> D[Final Recommendation]
    
    E[Switching] --> F[Choose best method]
    G[Cascade] --> H[Filter then rank]
```

---

## üí™ 7. B√†i t·∫≠p th·ª±c h√†nh

### üéØ B√†i t·∫≠p 1: X√¢y d·ª±ng h·ªá th·ªëng g·ª£i √Ω phim
S·ª≠ d·ª•ng MovieLens dataset ƒë·ªÉ:
1. Implement User-based CF
2. Implement Item-based CF  
3. So s√°nh hi·ªáu su·∫•t hai ph∆∞∆°ng ph√°p

### üéØ B√†i t·∫≠p 2: Content-based cho s·∫£n ph·∫©m
T·∫°o h·ªá th·ªëng g·ª£i √Ω s·∫£n ph·∫©m d·ª±a tr√™n:
1. M√¥ t·∫£ s·∫£n ph·∫©m (TF-IDF)
2. ƒê·∫∑c tr∆∞ng category, price, brand
3. K·∫øt h·ª£p c·∫£ hai

### üéØ B√†i t·∫≠p 3: ƒê√°nh gi√° v√† t·ªëi ∆∞u
1. Implement cross-validation cho recommendation
2. T√≠nh to√°n c√°c metrics: MAE, RMSE, Precision@K
3. T·ªëi ∆∞u hyperparameters

---

## üèÜ 8. ∆Øu v√† nh∆∞·ª£c ƒëi·ªÉm

### ‚úÖ ∆Øu ƒëi·ªÉm c·ªßa Recommendation Systems
- **üéØ C√° nh√¢n h√≥a**: T·∫°o tr·∫£i nghi·ªám ri√™ng cho t·ª´ng user
- **üí∞ TƒÉng doanh thu**: Khuy·∫øn kh√≠ch mua s·∫Øm th√™m
- **‚è∞ Ti·∫øt ki·ªám th·ªùi gian**: Gi√∫p user t√¨m s·∫£n ph·∫©m nhanh h∆°n
- **üîç Kh√°m ph√°**: Gi·ªõi thi·ªáu s·∫£n ph·∫©m m·ªõi user ch∆∞a bi·∫øt

### ‚ùå Th√°ch th·ª©c
- **üÜï Cold Start**: Kh√≥ g·ª£i √Ω cho user/item m·ªõi
- **üìä Data Sparsity**: Ma tr·∫≠n rating th∆∞·ªùng r·∫•t th∆∞a
- **üîÑ Scalability**: Kh√≥ m·ªü r·ªông v·ªõi d·ªØ li·ªáu l·ªõn
- **üé≠ Filter Bubble**: C√≥ th·ªÉ t·∫°o bong b√≥ng l·ªçc th√¥ng tin

---

## üìö 9. T√†i li·ªáu tham kh·∫£o

### üìñ S√°ch v√† b√†i vi·∫øt
1. **"Recommender Systems: An Introduction"** - Jannach et al.
2. **"Programming Collective Intelligence"** - Toby Segaran
3. **"Hands-On Recommendation Systems with Python"** - Rounak Banik

### üåê Ngu·ªìn online
1. [Coursera - Recommender Systems Specialization](https://www.coursera.org/specializations/recommender-systems)
2. [Surprise Library Documentation](https://surprise.readthedocs.io/)
3. [Netflix Prize Competition](https://www.kaggle.com/netflix-inc/netflix-prize-data)

### üîß Th∆∞ vi·ªán v√† tools
1. **Surprise**: Th∆∞ vi·ªán Python cho collaborative filtering
2. **LightFM**: Hybrid recommendation algorithms  
3. **Implicit**: Fast collaborative filtering for implicit datasets
4. **TensorFlow Recommenders**: Deep learning cho recommendation

### üìä Datasets th·ª±c h√†nh
1. **MovieLens**: http://movielens.org/
2. **Amazon Product Data**: http://jmcauley.ucsd.edu/data/amazon/
3. **Last.fm**: https://www.last.fm/api
4. **Goodreads**: https://sites.google.com/eng.ucsd.edu/ucsdbookgraph/

---

## üé® Visual Illustrations

### üìä T·ªïng quan c√°c ph∆∞∆°ng ph√°p
![Comparison of Recommendation Methods](images/recommendation_methods_comparison.png)

### ü§ù Collaborative Filtering Process
![Collaborative Filtering Workflow](images/collaborative_filtering_process.png)

### üìä Content-based Filtering
![Content-based Filtering Process](images/content_based_filtering.png)

### üìà User-Item Matrix
![User-Item Matrix Structure](images/user_item_matrix.png)

### üî§ TF-IDF Illustration
![TF-IDF Process](images/tfidf_illustration.png)

---

## üéâ K·∫øt lu·∫≠n

H·ªá th·ªëng g·ª£i √Ω l√† m·ªôt trong nh·ªØng ·ª©ng d·ª•ng quan tr·ªçng nh·∫•t c·ªßa Machine Learning trong th∆∞∆°ng m·∫°i ƒëi·ªán t·ª≠ v√† c√°c n·ªÅn t·∫£ng k·ªπ thu·∫≠t s·ªë. Vi·ªác hi·ªÉu r√µ nguy√™n l√Ω v√† c√°ch tri·ªÉn khai c√°c ph∆∞∆°ng ph√°p Content-based v√† Collaborative Filtering s·∫Ω gi√∫p b·∫°n x√¢y d·ª±ng ƒë∆∞·ª£c nh·ªØng h·ªá th·ªëng g·ª£i √Ω hi·ªáu qu·∫£, tƒÉng tr·∫£i nghi·ªám ng∆∞·ªùi d√πng v√† gi√° tr·ªã kinh doanh.

**üìù ƒêi·ªÉm quan tr·ªçng c·∫ßn nh·ªõ:**
- Ch·ªçn ph∆∞∆°ng ph√°p ph√π h·ª£p v·ªõi d·ªØ li·ªáu v√† m·ª•c ti√™u
- K·∫øt h·ª£p nhi·ªÅu ph∆∞∆°ng ph√°p ƒë·ªÉ t·∫≠n d·ª•ng ∆∞u ƒëi·ªÉm
- Lu√¥n ƒë√°nh gi√° v√† t·ªëi ∆∞u h·ªá th·ªëng th∆∞·ªùng xuy√™n
- Xem x√©t ƒë·∫øn c√°c y·∫øu t·ªë th·ª±c t·∫ø nh∆∞ scalability v√† interpretability
